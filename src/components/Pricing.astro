---
import getData from "../data/pricing.data";
import { useTypography } from "../lib/typography";
import Button from "./Button.astro";

const t = useTypography(Astro.locals.lang);
const data = getData(t);
---

<section
  class="section pricing-section"
  id="services-pricing"
  aria-labelledby="pricing-title"
>
  <div class="section-container">
    <div class="section-header">
      <h2 class="section-title" id="pricing-title">
        {t("pricing.heading")}
      </h2>
    </div>

    <div class="pricing-grid stagger-children">
      {
        data.items.map((plan) => (
          <div class={`pricing-card`}>
            <div class="pricing-head">
              <h3 class="pricing-name">{plan.title}</h3>
              <p class="pricing-desc">{plan.description}</p>
            </div>
            <div class="pricing-amount">
              {!plan.isFixedPrice && (
                <span class="pricing-from">{t("pricing.startingAt")}</span>
              )}
              <span class="pricing-price">{plan.price}</span>
              <span class="pricing-estimation">
                <svg
                  width="14"
                  height="14"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  aria-hidden="true"
                >
                  <circle cx="12" cy="12" r="10" />
                  <polyline points="12 6 12 12 16 14" />
                </svg>
                {plan.estimation}
              </span>
            </div>
            <ul class="pricing-features" role="list">
              {plan.features.map((feature) => (
                <li>
                  <svg
                    width="15"
                    height="15"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                  >
                    <polyline points="20 6 9 17 4 12" />
                  </svg>
                  {feature}
                </li>
              ))}
            </ul>
            <Button href="#contact" variant="secondary">
              {t("pricing.cta")}
            </Button>
          </div>
        ))
      }
    </div>
  </div>
</section>

<style>
  .pricing-section {
    background: linear-gradient(135deg, var(--color-accent) 0%, #0ea5e9 100%);
  }

  .pricing-section :global(.section-title) {
    color: #fff;
  }

  .pricing-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
    max-width: 1100px;
    margin: 0 auto;
    align-items: start;
  }

  .pricing-card {
    background: var(--color-surface);
    border: 1px solid var(--color-border-subtle);
    border-radius: var(--radius-xl);
    padding: 1.75rem;
    position: relative;
    transition: all var(--transition-fast);
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .pricing-card:hover {
    border-color: var(--color-border);
    box-shadow: var(--shadow-lg);
    transform: translateY(-2px);
  }

  .pricing-head {
    flex: 1;
    margin-bottom: 1.25rem;
  }

  .pricing-name {
    font-size: 1.0625rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    margin-bottom: 0.25rem;
  }

  .pricing-desc {
    font-size: 0.8125rem;
    color: var(--color-text-secondary);
    line-height: 1.5;
  }

  .pricing-amount {
    margin-bottom: 1.5rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--color-border-subtle);
  }

  .pricing-from {
    display: block;
    font-size: 0.6875rem;
    font-weight: 500;
    color: var(--color-text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin-bottom: 0.125rem;
  }

  .pricing-price {
    font-size: 1.75rem;
    font-weight: 800;
    color: var(--color-text);
    letter-spacing: -0.03em;
  }

  .pricing-estimation {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    margin-top: 0.5rem;
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--color-text-tertiary);
  }

  .pricing-estimation svg {
    flex-shrink: 0;
  }

  .pricing-features {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    flex: 1;
  }

  .pricing-features li {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    font-size: 0.8125rem;
    color: var(--color-text-secondary);
    line-height: 1.4;
  }

  .pricing-features svg {
    flex-shrink: 0;
    color: var(--color-success);
    margin-top: 0.1rem;
  }

  .pricing-cta {
    width: 100%;
    padding: 0.75rem 1.5rem;
    font-size: 0.875rem;
  }

  @media (max-width: 1024px) {
    .pricing-grid {
      grid-template-columns: repeat(2, 1fr);
      max-width: 600px;
    }
  }

  @media (max-width: 540px) {
    .pricing-grid {
      grid-template-columns: 1fr;
      max-width: 360px;
    }
  }

  /* ── Animations ──────────────────────────────────────────────── */
  .animate-on-scroll {
    opacity: 0;
    transform: translateY(24px);
    transition:
      opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1),
      transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .animate-on-scroll.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* stagger children */
  .stagger-children .animate-on-scroll:nth-child(1) {
    transition-delay: 0ms;
  }
  .stagger-children .animate-on-scroll:nth-child(2) {
    transition-delay: 80ms;
  }
  .stagger-children .animate-on-scroll:nth-child(3) {
    transition-delay: 160ms;
  }
  .stagger-children .animate-on-scroll:nth-child(4) {
    transition-delay: 240ms;
  }
  .stagger-children .animate-on-scroll:nth-child(5) {
    transition-delay: 320ms;
  }
  .stagger-children .animate-on-scroll:nth-child(6) {
    transition-delay: 400ms;
  }
</style>

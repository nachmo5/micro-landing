---
import { Image } from "astro:assets";
import circlesImage from "../assets/circles.png";
import getData from "../data/home.data";
import { useTypography } from "../lib/typography";
import Button from "./Button.astro";

const t = useTypography(Astro.locals.lang);
const data = getData(t);
---

<section id="hero" aria-labelledby="hero-heading">
  <!-- Decorative background circles -->
  <Image
    src={circlesImage}
    alt="decoration1"
    role="presentation"
    class="hidden lg:block absolute left-10 bottom-10 w-20 h-20 opacity-40 pointer-events-none select-none"
    loading="eager"
  />
  <Image
    src={circlesImage}
    alt="decoration2"
    role="presentation"
    class="hidden lg:block absolute right-40 top-10 w-20 h-20 opacity-40 pointer-events-none select-none"
    loading="eager"
  />

  <div
    class="relative z-10 mx-auto w-full max-w-7xl px-6 py-16 lg:py-0 flex flex-col lg:flex-row items-center justify-between gap-12 lg:gap-8"
  >
    <!-- Copy -->
    <div class="max-w-xl text-center lg:text-left">
      <h1
        id="hero-heading"
        class="text-4xl sm:text-5xl lg:text-6xl font-bold tracking-tight text-gray-900 leading-tight"
      >
        <span class="whitespace-nowrap">{t("home.main.title1")}</span><br />
        <span id="title2" class="whitespace-nowrap"
          >{t("home.main.title2")}</span
        >
      </h1>
      <p class="mt-4 text-lg sm:text-xl text-gray-500 leading-relaxed">
        {t("home.main.subtitle")}
      </p>
      <div class="mt-8 flex flex-wrap gap-4 justify-center lg:justify-start">
        <Button href="#contact" size="lg">
          {t("home.main.contactButton")}
          <svg
            width="15"
            height="15"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            aria-hidden="true"
            ><line x1="7" y1="17" x2="17" y2="7"></line><polyline
              points="7 7 17 7 17 17"></polyline></svg
          >
        </Button>
        <Button href="#projects" variant="secondary" size="lg">
          {t("home.main.projectsButton")}
        </Button>
      </div>
    </div>

    <!-- Services grid -->
    <div class="services-container">
      <div class="services-grid">
        {
          data.main.services.map((service, i) => (
            <a href="#services-pricing" class="tile">
              <Image
                src={service.image}
                alt={service.title}
                class="tile-img"
                loading="eager"
              />
              <span class="tile-label">{service.title}</span>
            </a>
          ))
        }
      </div>
    </div>
  </div>
</section>

<style>
  #hero {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 80vh;
    overflow: hidden;
    background:
      linear-gradient(to bottom right, #f1f2f6 20%, transparent 0) top left /
        50% 80% no-repeat,
      linear-gradient(to top left, #f1f2f6 50%, transparent 0) bottom right /
        50% 100% no-repeat,
      linear-gradient(rgb(255, 255, 255), rgb(248, 248, 251));
  }

  #title2 {
    background: linear-gradient(135deg, var(--color-accent) 0%, #0ea5e9 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* ---- Services grid ---- */
  .services-container {
    flex-shrink: 0;
  }

  @media (min-width: 640px) {
    .services-container {
      padding: 1.25rem;
    }
  }

  @media (min-width: 1024px) {
    .services-container {
      padding: 1.5rem;
    }
  }

  .services-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    width: 280px;
  }

  @media (min-width: 640px) {
    .services-grid {
      width: 360px;
      gap: 1.25rem;
    }
  }

  @media (min-width: 1024px) {
    .services-grid {
      width: 420px;
      gap: 1.5rem;
    }
  }

  .tile {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    padding: 1.25rem 1rem;
    border-radius: var(--radius-xl);
    border: 1.5px solid var(--color-border-subtle);
    background: linear-gradient(rgb(255, 255, 255), rgb(248, 248, 251));
    box-shadow: var(--shadow-sm);
    text-decoration: none;
    cursor: pointer;
    transition:
      transform var(--transition-base),
      box-shadow var(--transition-base),
      border-color var(--transition-base);
  }

  .tile.active,
  .tile:hover {
    transform: translateY(-6px) scale(1.04);
    box-shadow: var(--shadow-lg);
    border-color: var(--color-border);
  }

  .tile-img {
    width: 64px;
    height: 64px;
    object-fit: contain;
  }

  .tile-label {
    font-size: 0.8125rem;
    font-weight: 600;
    color: var(--color-text-secondary);
    text-align: center;
    line-height: 1.3;
  }

  @media (min-width: 640px) {
    .tile {
      padding: 1.5rem 1.25rem;
    }
    .tile-img {
      width: 80px;
      height: 80px;
    }
    .tile-label {
      font-size: 0.875rem;
    }
  }

  @media (min-width: 1024px) {
    .tile {
      padding: 1.75rem 1.5rem;
    }
    .tile-img {
      width: 96px;
      height: 96px;
    }
    .tile-label {
      font-size: 0.9375rem;
    }
  }
</style>

<script>
  const tiles = document.querySelectorAll<HTMLElement>(".tile");
  let current = 0;
  let interval: ReturnType<typeof setInterval>;
  let paused = false;

  function tick() {
    tiles.forEach((t) => t.classList.remove("active"));
    tiles[current]?.classList.add("active");
    current = (current + 1) % tiles.length;
  }

  function start() {
    tick();
    interval = setInterval(tick, 2000);
  }

  start();

  const grid = document.querySelector(".services-grid")!;
  grid.addEventListener("mouseenter", () => {
    paused = true;
    clearInterval(interval);
    tiles.forEach((t) => t.classList.remove("active"));
  });
  grid.addEventListener("mouseleave", () => {
    paused = false;
    start();
  });
</script>
